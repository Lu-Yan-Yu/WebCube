<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Geospatial API AR</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@googlemaps/ar@1.0.2/dist/index.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <!-- 页面内容 -->
    <div id="map"></div>
    <a-scene embedded arjs>
        <!-- 模型 -->
        <a-entity id="shapeEntity"
                  geometry="primitive: box; height: 0.5; width: 0.5; depth: 0.5"
                  material="color: rgb(70, 130, 180)">
        </a-entity>
        <!-- 摄像头 -->
        <a-camera gps-camera></a-camera>
    </a-scene>

    <script>
        // 配置 API 密钥
        const API_KEY = "AIzaSyAkYeCPMKQ8y72C0Pa1zOXPNFswsfjejpk";

        // 初始化 Geospatial API
        async function initializeGeospatial() {
            if (!navigator.xr) {
                alert("您的设备不支持 WebXR。");
                return;
            }

            const session = await navigator.xr.requestSession("immersive-ar", {
                requiredFeatures: ["local-floor", "geospatial"],
            });

            // 初始化 Google Maps Geospatial API
            const geospatial = await session.requestFeature("geospatial");
            const viewer = new google.maps.visualization.Viewer({
                map: document.getElementById("map"),
                apiKey: API_KEY,
            });

            // 设置目标位置的经纬度
            const targetLocation = {
                latitude: 22.998774,
                longitude: 120.219917,
                altitude: 10, // 可选：设置目标位置的高度（单位：米）
            };

            // 添加 Anchor
            viewer.addAnchor({
                position: targetLocation,
                rotation: { x: 0, y: 0, z: 0 },
                model: {
                    uri: "path/to/3d-model.glb", // 替换为您的模型路径
                    scale: { x: 1, y: 1, z: 1 },
                },
            });

            viewer.render();
        }

        // 执行初始化
        initializeGeospatial();
    </script>
</body>
</html>
